<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LinguistAI - Tu Tutor Personal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .perspective { perspective: 1000px; }
        .card-inner { transition: transform 0.6s; transform-style: preserve-3d; cursor: pointer; }
        .flipped { transform: rotateY(180deg); }
        .card-face { backface-visibility: hidden; position: absolute; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; border-radius: 1rem; font-size: 1.5rem; font-weight: bold; }
        .card-back { transform: rotateY(180deg); background-color: #4f46e5; color: white; }
        .card-front { background-color: white; border: 2px solid #4f46e5; color: #1e293b; }
    </style>
</head>
<body class="bg-slate-100 font-sans min-h-screen">

    <nav class="bg-indigo-700 p-4 text-white shadow-xl sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-black tracking-tighter">LINGUIST<span class="text-indigo-300">AI</span></h1>
            <div id="score-badge" class="bg-indigo-900 px-4 py-1 rounded-full text-sm font-bold">‚≠ê Puntos: 0</div>
        </div>
    </nav>

    <main class="container mx-auto p-4 max-w-2xl pb-24">
        
        <section class="mt-6">
            <h2 class="text-center text-slate-600 font-bold mb-4 uppercase tracking-widest text-xs">Vocabulario Diario</h2>
            <div class="flex justify-center">
                <div class="w-72 h-44 perspective">
                    <div id="card-inner" class="card-inner relative w-full h-full shadow-2xl">
                        <div class="card-face card-front" id="word-en">Apple</div>
                        <div class="card-face card-back" id="word-es">Manzana</div>
                    </div>
                </div>
            </div>
        </section>

        <section class="mt-12">
            <h2 class="text-slate-600 font-bold mb-4 uppercase tracking-widest text-xs">Conversaci√≥n con IA</h2>
            <div id="chat-box" class="bg-white h-80 overflow-y-auto p-4 rounded-2xl shadow-inner border border-slate-200 space-y-4 mb-4 scroll-smooth">
                <div class="bg-slate-100 p-3 rounded-2xl rounded-tl-none text-sm w-4/5 text-slate-800">
                    <strong>Tutor:</strong> Hello! I'm your AI teacher. Let's practice! How was your day? (Puedes hablarme o escribirme).
                </div>
            </div>
            
            <div class="flex items-center gap-2 bg-white p-2 rounded-full shadow-lg border border-slate-200">
                <button onclick="startListening()" class="bg-red-500 hover:bg-red-600 text-white w-12 h-12 rounded-full flex items-center justify-center transition-all active:scale-90 shadow-md" title="Hablar">
                    üé§
                </button>
                <input id="user-input" type="text" placeholder="Escribe en ingl√©s..." class="flex-1 bg-transparent border-none outline-none px-2 text-slate-700">
                <button onclick="sendMessage()" class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-full font-bold transition-all shadow-md">
                    Enviar
                </button>
            </div>
        </section>
    </main>

    <script>
        // CONFIGURACI√ìN - PON TU KEY AQU√ç
        const GEMINI_API_KEY = "TU_API_KEY_AQU√ç"; 
        
        let points = 0;
        const cardInner = document.getElementById('card-inner');
        const chatBox = document.getElementById('chat-box');
        const userInput = document.getElementById('user-input');

        // --- L√ìGICA DE FLASHCARDS ---
        cardInner.addEventListener('click', () => {
            cardInner.classList.toggle('flipped');
            if(cardInner.classList.contains('flipped')) {
                points += 5;
                updateScore();
            }
        });

        function updateScore() {
            document.getElementById('score-badge').innerText = ‚≠ê Puntos: ${points};
        }

        // --- L√ìGICA DE VOZ (SPEECH) ---
        function speak(text) {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'en-US';
            utterance.rate = 0.9; // Un poco m√°s lento para entender mejor
            window.speechSynthesis.speak(utterance);
        }

        function startListening() {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            if (!SpeechRecognition) {
                alert("Tu navegador no soporta reconocimiento de voz.");
                return;
            }
            const recognition = new SpeechRecognition();
            recognition.lang = 'en-US';
            
            recognition.onstart = () => { userInput.placeholder = "Escuchando..."; };
            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                userInput.value = transcript;
                sendMessage();
            };
            recognition.onerror = () => { userInput.placeholder = "Escribe en ingl√©s..."; };
            recognition.start();
        }

        // --- CONEXI√ìN CON GEMINI IA ---
        async function sendMessage() {
            const text = userInput.value.trim();
            if (!text) return;

            // Mostrar mensaje del usuario
            appendMessage("T√∫", text, "bg-indigo-100 text-indigo-900 ml-auto rounded-tr-none");
            userInput.value = "";
            userInput.placeholder = "IA pensando...";

            try {
                const response = await fetch(https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${GEMINI_API_KEY}, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{ text: Eres un profesor de ingl√©s amable. El usuario dice: "${text}". Si tiene errores gramaticales, corr√≠gelos de forma breve. Si es correcto, felic√≠talo. Siempre responde con una pregunta corta para seguir la charla. }]
                        }]
                    })
                });

                const data = await response.json();
                const aiResponse = data.candidates[0].content.parts[0].text;

                appendMessage("Tutor", aiResponse, "bg-slate-100 text-slate-800 mr-auto rounded-tl-none");
                speak(aiResponse); // La IA habla
                points += 2; // Puntos por conversar
                updateScore();

            } catch (error) {
                appendMessage("Error", "Revisa tu API Key o conexi√≥n.", "bg-red-100 text-red-800 mx-auto");
            }

            userInput.placeholder = "Escribe en ingl√©s...";
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        function appendMessage(sender, text, classes) {
            const msgDiv = document.createElement("div");
            msgDiv.className = p-3 rounded-2xl text-sm w-4/5 shadow-sm ${classes};
            msgDiv.innerHTML = <strong>${sender}:</strong> ${text};
            chatBox.appendChild(msgDiv);
            chatBox.scrollTop = chatBox.scrollHeight;
        }
    </script>
</body>
</html>